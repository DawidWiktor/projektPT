{% extends 'main_app/base.html' %}

{% block middle %}

    <div class="wrapper">
    <div class="main-panel">
        <nav class="navbar navbar-default navbar-fixed">
            <div class="container-fluid">
                <div class="navbar-header">
                    <a class="navbar-brand">Dashboard</a>
                </div>
            </div>
        </nav>


        <div class="content">
            <div class="container-fluid">
                <div class="row">

                    <div class="col-md-12">
                        <div class="card">
                            <div class="header">
                                <h4 class="title">Lorem Ipsum</h4>
                                <p class="category">Lorem Ipsum</p>
                            </div>
                            <div class="content">
                                <form name="form" action="{% url 'main_app:board' %}" method="POST">
                                    {% csrf_token %}
                                    Tagi (max 7):
                                    <input name='tags' placeholder='tagi' value=''>
                                    Źródła ('wszystkie'):
                                    <input name='sources' placeholder='źródła' value=''>
                                    <br/>
                                    <br/>
                                    Data od:
                                    <input type="date" name="from">
                                    <br/>
                                    Data do:
                                    <input type="date" name="to">
                                    <br/><br/>
                                    <button type="submit" class="btn btn-default" value="Szukaj" class="form login">
                                        Szukaj
                                    </button>
                                    <br/>
                                </form>
                            </div>
                        </div>
                    </div>

                    {% if chosen_tags and chosen_sources %}
                        <h3>Wybrane tagi:</h3>
                            {% for tag in chosen_tags %}
                                {{ tag }}<br/>
                            {% endfor %}
                        <h3>Wybrane źródła:</h3>
                            {% for source in chosen_sources %}
                                {{ source }}<br/>
                            {% endfor %}
                        <h3>Przedział czasowy:</h3>
                            Od: {{ date_from|date:'Y-m-d' }}<br/>
                            Do: {{ date_to|date:'Y-m-d' }}
                    {% endif %}
                <br/>
                    {% for article in articles %}
                        <div class="col-md-12">
                            <div class="card">
                                <div class="header">
                                    </br>
                                    <a href="{{ article.link }}">
                                        <h2 class="title">{{ article.title }}</h2>
                                    </a>
                                    <hr>
                                </div>
                                <div class="content">
                                    <img src="{{ article.imageLink }}" alt="{{ article.sourceID }}" height="100"
                                         width="100" border="1px">
                                    <p>{{ article.text }}</p>
                                    <br>
                                    <br>
                                </div>
                                <div class="content">
                                    <hr>
                                    <p><b><i class="fa fa-hashtag" aria-hidden="true"></i> Tagi:</b> {{ article.tags }}
                                    <p>
                                    <p><b><i class="fa fa-info-circle" aria-hidden="true"></i>
                                        Źródło:</b> {{ article.sourceID }} <b><i class="fa fa-users"
                                                                                 aria-hidden="true"></i>
                                        Autor:</b> {{ article.author }}
                                        <b><i class="fa fa-calendar-o" aria-hidden="true"></i>
                                            Data:</b> {{ article.timestamp }}</p>
                                </div>
                            </div>
                        </div>
                    {% endfor %}

                </div>
            </div>
        </div>
    </div>

    <script type="text/javascript">
        //document.forms[0].reset();
        var input1 = document.querySelector('input[name=tags]');
        // init Tagify script on the above inputs
        tagify1 = new Tagify(input1, {
            whitelist: {{ tags_list|safe }},
            maxTags: 7,
            enforeWhitelist: true,
            autocomplete: true
        });

        var input2 = document.querySelector('input[name=sources]');
        // init Tagify script on the above inputs
        tagify1 = new Tagify(input2, {
            whitelist: {{ sources_list|safe }},
            enforeWhitelist: true,
            autocomplete: true
        });


        // add tag callback
        function onAddTag(e) {
            console.log(e, e.detail);
        }

        // remove tag callback
        function onRemoveTag(e) {
            console.log(e, e.detail);
        }

        function onDuplicateAdded(e) {
            console.log(e, e.detail);
        }

        //tagify1.on('add', onAddTag);
        //tagify1.on('remove', onRemoveTag);
        //tagify1.on('duplicate', onDuplicateAdded);
    </script>

{% endblock %}
